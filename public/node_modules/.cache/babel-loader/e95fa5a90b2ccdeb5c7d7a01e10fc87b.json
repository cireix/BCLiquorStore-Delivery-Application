{"ast":null,"code":"import _regeneratorRuntime from\"/home/eric/Desktop/CMPT276/CMPT276/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/eric/Desktop/CMPT276/CMPT276/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{useForm}from'react-hook-form';import axios from'commons/axios';import{toast}from'react-toastify';import decode from'jwt-decode';export default function Login(props){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors,watch=_useForm.watch;var onSubmit=function onSubmit(data){var nickname=data.nickname,phoneNumber=data.phoneNumber,password=data.password;// post to server side for register        \naxios.post('/api/users/register',{name:nickname,phone:phoneNumber,password:password,password2:password,type:1}).then(function(res){console.log('res=>',res);}).catch(function(err){return console.log(err);});};var onSubmit2=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var phoneNumber,code,res,jwToken;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;phoneNumber=data.phoneNumber,code=data.code;// post to server side for register\n_context.next=4;return axios.post('/api/users/register2',{phone:phoneNumber,code:code});case 4:res=_context.sent;// receive a jwtoken from server side if successful\njwToken=res.data.token.replace('Bearer ','');console.log(decode(jwToken));// store the token locally\nglobal.auth.setToken(jwToken);// route to the home page \nprops.history.push('/');toast.success(\"Sign up successfully!\");_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.log(_context.t0);toast.error(\"This phone number already exists\");case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function onSubmit2(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"login_wrapper\"},/*#__PURE__*/React.createElement(\"form\",{className:\"box login_box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"field\"},/*#__PURE__*/React.createElement(\"label\",{className:\"label\"},\"Name\"),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},/*#__PURE__*/React.createElement(\"input\",{className:\"input \".concat(errors.nickname&&'is-danger'),type:\"text\",placeholder:\"Nickname\",name:\"nickname\",ref:register({required:true,maxLength:{value:10,message:'cannot be more than 10 digits'}})}),errors.nickname&&/*#__PURE__*/React.createElement(\"p\",{className:\"helper has-text-danger\"},errors.nickname.message))),/*#__PURE__*/React.createElement(\"div\",{className:\"field\"},/*#__PURE__*/React.createElement(\"label\",{className:\"label\"},\"Phone Number\"),/*#__PURE__*/React.createElement(\"div\",{class:\"field-body\"},/*#__PURE__*/React.createElement(\"div\",{class:\"field is-expanded\"},/*#__PURE__*/React.createElement(\"div\",{class:\"field has-addons\"},/*#__PURE__*/React.createElement(\"p\",{class:\"control\"},/*#__PURE__*/React.createElement(\"p\",{class:\"button is-static\"},\"+1\")),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"input \".concat(errors.phoneNumber&&'is-danger'),placeholder:\"Phone number\",name:\"phoneNumber\",ref:register({required:true,pattern:{value:/^\\(?([0-9]{3})\\)?[-.●]?([0-9]{3})[-.●]?([0-9]{4})$/,message:\"invalid phone number\"}})})),errors.phoneNumber&&/*#__PURE__*/React.createElement(\"p\",{className:\"helper has-text-danger\"},errors.phoneNumber.message)))),/*#__PURE__*/React.createElement(\"div\",{className:\"field\"},/*#__PURE__*/React.createElement(\"label\",{className:\"label\"},\"Password\"),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},/*#__PURE__*/React.createElement(\"input\",{className:\"input \".concat(errors.password&&'is-danger'),type:\"text\",placeholder:\"Password\",name:\"password\",ref:register({required:true,minLength:{value:6,message:'cannot be less than 6 digits'}})}),errors.password&&/*#__PURE__*/React.createElement(\"p\",{className:\"helper has-text-danger\"},errors.password.message))),/*#__PURE__*/React.createElement(\"div\",{className:\"field\"},/*#__PURE__*/React.createElement(\"label\",{className:\"label\"},\"Confirm Password\"),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},/*#__PURE__*/React.createElement(\"input\",{className:\"input \".concat(errors.password2&&'is-danger'),type:\"text\",placeholder:\"Confirm Password\",name:\"password2\",ref:register({required:true,validate:function validate(value){return value===watch('password');}})}),errors.password2&&/*#__PURE__*/React.createElement(\"p\",{className:\"helper has-text-danger\"},\"must match the qrevious entry\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},/*#__PURE__*/React.createElement(\"button\",{className:\"button is-link login_button\",onClick:handleSubmit(onSubmit)},\"Get Authentication Code\")),/*#__PURE__*/React.createElement(\"div\",{className:\"field\"},/*#__PURE__*/React.createElement(\"label\",{className:\"label\"},\"Authentication Code\"),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},/*#__PURE__*/React.createElement(\"input\",{className:\"input \".concat(errors.code&&'is-danger'),type:\"number\",placeholder:\"Authentication Code\",name:\"code\",ref:register({maxLength:{value:6,message:'should be 6 digits'}})}),errors.code&&/*#__PURE__*/React.createElement(\"p\",{className:\"helper has-text-danger\"},errors.code.message))),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},/*#__PURE__*/React.createElement(\"button\",{className:\"button is-link login_button\",onClick:handleSubmit(onSubmit2)},\"Submit\"))));}","map":{"version":3,"sources":["/home/eric/Desktop/CMPT276/CMPT276/client/src/pages/SignUp.js"],"names":["React","useForm","axios","toast","decode","Login","props","register","handleSubmit","errors","watch","onSubmit","data","nickname","phoneNumber","password","post","name","phone","password2","type","then","res","console","log","catch","err","onSubmit2","code","jwToken","token","replace","global","auth","setToken","history","push","success","error","required","maxLength","value","message","pattern","minLength","validate"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {useForm} from 'react-hook-form';\nimport axios from 'commons/axios';\nimport { toast } from 'react-toastify';\nimport decode from 'jwt-decode';\n\nexport default function Login(props) {\n    const { register, handleSubmit, errors, watch } = useForm();\n    \n    const onSubmit = data => {    \n\n            const { nickname, phoneNumber, password } = data;\n            // post to server side for register        \n            axios.post('/api/users/register', { name: nickname, phone: phoneNumber, password: password, password2:password,type: 1 }).then(res=>{console.log('res=>',res); })\n            .catch((err)=>console.log(err));\n\n    };\n\n    const onSubmit2 = async(data) => {    \n        try {\n            const { phoneNumber, code } = data;\n            // post to server side for register\n            const res = await axios.post('/api/users/register2', { phone: phoneNumber,code });  \n            // receive a jwtoken from server side if successful\n            const jwToken = res.data.token.replace('Bearer ','');\n            console.log(decode(jwToken));\n            // store the token locally\n            global.auth.setToken(jwToken); \n            // route to the home page \n            props.history.push('/');\n            toast.success(\"Sign up successfully!\");\n        } catch (error) {\n            console.log(error);\n            toast.error(\"This phone number already exists\");\n        }\n};\n\n\n    return(\n        <div className=\"login_wrapper\">\n            <form className=\"box login_box\" >\n                <div className=\"field\">\n                    <label className=\"label\">Name</label>\n                    <div className=\"control\">\n                        <input \n                        className={`input ${errors.nickname && 'is-danger'}`}  \n                        type=\"text\" \n                        placeholder=\"Nickname\" \n                        name='nickname'     \n                        ref={ register({       \n                            required: true,\n                            maxLength: {\n                                value: 10,\n                                message: 'cannot be more than 10 digits'\n                            }}) }  />   \n                        { errors.nickname && <p className=\"helper has-text-danger\">{ errors.nickname.message }</p> }  \n                    </div>\n                </div>\n\n                <div className=\"field\">\n                    <label className=\"label\">Phone Number</label>             \n                    <div class=\"field-body\">\n                        <div class=\"field is-expanded\">\n                            <div class=\"field has-addons\">\n                                <p class=\"control\">\n                                <p class=\"button is-static\">+1</p>\n                                </p>\n                                <input \n                                type=\"text\" \n                                className={`input ${errors.phoneNumber && 'is-danger'}`}\n                                placeholder=\"Phone number\" \n                                name=\"phoneNumber\"\n                                ref={register({\n                                    required: true,\n                                    pattern:{\n                                        value: /^\\(?([0-9]{3})\\)?[-.●]?([0-9]{3})[-.●]?([0-9]{4})$/,\n                                        message: \"invalid phone number\"\n                                }})} />  \n                            </div>\n                            { errors.phoneNumber && <p className=\"helper has-text-danger\">{ errors.phoneNumber.message }</p >}\n                        </div>\n                    </div>                        \n                </div>\n\n                <div className=\"field\">\n                    <label className=\"label\">Password</label>\n                    <div className=\"control\">\n                        <input \n                        className={`input ${errors.password && 'is-danger'}`}\n                        type=\"text\" \n                        placeholder=\"Password\" \n                        name='password'     \n                        ref={ register({ \n                            required: true,\n                            minLength: {\n                                value: 6,\n                                message: 'cannot be less than 6 digits'\n                            }}) } />\n                        { errors.password && <p className=\"helper has-text-danger\">{ errors.password.message }</p> } \n                    </div>\n                </div>\n\n                <div className=\"field\">\n                    <label className=\"label\">Confirm Password</label>\n                    <div className=\"control\">\n                        <input \n                        className={`input ${errors.password2 && 'is-danger'}`}  \n                        type=\"text\" \n                        placeholder=\"Confirm Password\" \n                        name='password2'     \n                        ref={ register({       \n                            required: true,\n                            validate: (value) => value === watch('password')\n                            }) }  />   \n                        { errors.password2 && <p className=\"helper has-text-danger\">must match the qrevious entry</p> }  \n                    </div>\n                </div>\n\n                <div className=\"control\">\n                    <button className=\"button is-link login_button\" onClick={handleSubmit(onSubmit)}>Get Authentication Code</button>\n                </div>\n\n                <div className=\"field\">\n                    <label className=\"label\">Authentication Code</label>\n                    <div className=\"control\">\n                        <input \n                        className={`input ${errors.code && 'is-danger'}`}  \n                        type=\"number\" \n                        placeholder=\"Authentication Code\" \n                        name='code'     \n                        ref={ register({       \n                            maxLength: {\n                                value: 6,\n                                message: 'should be 6 digits'\n                            }}) }  />   \n                        { errors.code && <p className=\"helper has-text-danger\">{ errors.code.message }</p> }  \n                    </div>\n                </div>\n\n                <div className=\"control\">\n                    <button className=\"button is-link login_button\" onClick={handleSubmit(onSubmit2)}>Submit</button>\n                </div>\n            </form>\n        </div>      \n    );\n}"]},"metadata":{},"sourceType":"module"}